<!--
 * @Author: shgopher shgopher@gmail.com
 * @Date: 2024-09-21 23:43:21
 * @LastEditors: shgopher shgopher@gmail.com
 * @LastEditTime: 2024-10-02 18:20:01
 * @FilePath: /luban/系统设计基础/网络在系统设计中的作用/API网关/README.md
 * @Description: 
 * 
 * Copyright (c) 2024 by shgopher, All Rights Reserved. 
-->
# API 网关 (应用网关)
API 网关是所有请求的入口，它接收了所有的 http https tcp 的请求，并将请求转发给后面真正的服务，微服务模式下，这些服务一般都是一些容器，或者也可能是各个数据中心的各自的 API 网关，总而言之，API 网关是一切请求的入口处理工具，它工作相对较少，所以性能非常的高

API 网关通常被部署在后端服务的最前端，来充当安全保护，熔断，限流，等作用，**nginx 就是一个简单化的 api 网关**，不过常见的 api 网关并不是 nginx，比较常见的有 **kong**，**bfe** 等

下面我们以 API 网关 kong 为案例去介绍 API 网关。

## API 网关的作用
- **解耦后端架构**：或者说灵活配置后端架构，它将需求和真实处理的服务解耦，可以构建更加灵活多样的后端架构 (BaaS)

- **减少 TLS 协议的使用**，TLS 协议加上 http 组成了 https，但是要知道 https 因为多了一层协议，所以势必比单纯的 http 慢，而且 tls 证书也是要花钱的，如果我们配置了 API 网关只需要在最前端部署 tls 协议即可，BaaS 中的服务都可以使用 RPC 协议或者一般的 http 协议

- **API 网关增加安全性**，可以对入口流量做鉴权，限流，降级，黑名单，白名单等措施，与此同时，后端的服务也仅仅可以放开对于 API 网关的 ip 访问，从而避免了各种安全风险

- **API 网关减少了运维的难度**，所有流量都经过 API 网关，可以做日志记录，监控，统计，这些行为都变得更加简单

- **API 网关可以对流量进行统一更改**，比如对于流量进行 gzip 压缩；可以一次性升级所有服务的协议，它只要升级为 http2 或者 3 这种新的协议，对外的服务就相当于升级了所有服务的协议，因为你入口升级了嘛，后端是什么协议都无所谓了，反正暴漏给客户端的协议是升级了；还可以对数据进行格式的转换，例如 xml 转换为 json 等

![API 网关](./API网关.svg)
## 服务发现
## 服务注册中心
## Kong


