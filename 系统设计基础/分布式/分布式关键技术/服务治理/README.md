<!--
 * @Author: shgopher shgopher@gmail.com
 * @Date: 2025-05-18 10:51:37
 * @LastEditors: shgopher shgopher@gmail.com
 * @LastEditTime: 2025-05-18 22:42:51
 * @FilePath: /luban/系统设计基础/分布式/分布式关键技术/服务治理/README.md
 * @Description: 
 * 
 * Copyright (c) 2025 by shgopher, All Rights Reserved. 
-->
# 服务治理

服务治理应该关注下面的几个问题：

- 服务关键程度
- 服务依赖关系
- 服务发现
- 整个架构的版本管理
- 服务应用生命周期全管理

## 服务关键程度和服务的依赖关系
服务的关键程度跟技术没啥关系，还是需要架构师本身对于技术的了解去设定，比如某个业务为该项目的核心操作，核心业务，那么这个服务必然就是关键技术，比如某个服务只是一种辅助方案，比如是一个数据分析的服务，那么它必定被划分为非关键服务。


微服务是讲究任何服务之间都不应该有依赖关系，但是实际上某些底层的公有服务不可避免的被其它服务使用，所以这只是一个理想的状态，不过该公有服务必须健壮，否则该调用链条上的所有服务都将极大的受到影响，所以我们要梳理服务的调用链条，必须降低服务的依赖广度和深度，最底线的服务依赖关系是，**绝对不要有依赖环**这会带来极强的耦合关系，非常可能出现递归错误

通常我们使用依赖倒置的设计模式 (通过抽象解耦模块间的依赖关系，使系统更灵活、可维护) 去规避依赖环这个问题，比如引入一个第三方中间件，例如消息队列，数据库等去解耦两者的依赖关系。

我们可以使用[链路追踪](../链路追踪/README.md)来查看服务调用关系，来规避服务的依赖关系。

## 服务状态和生命周期的管理
我们需要一个服务注册的组件去管理服务的状态，以及服务的生命周期。因为服务是是非常动态的，有的服务会新加进来，有的会离开，有的会增加更多的实例，有的会减少，有的服务在维护过程中 (发布、伸缩等)

我们需要注册中心 (实现服务发现的关键组件) 去管理整个架构中有多少种服务？这些服务的版本是什么样的？每个服务的实例数有多少个，它们的状态是什么样的？每个服务的状态是什么样的？是在部署中，运行中，故障中，升级中，还是在回滚中，伸缩中，或者是在下线中。

服务的生命周期通常有以下状态：
- Provision，代表在供应一个新的服务；
- Ready，表示启动成功了；
- Run，表示通过了服务健康检查；
- Update，表示在升级中；
- Rollback，表示在回滚中；
- Scale，表示正在伸缩中 (可以有 Scale-in 和 Scale-out 两种)；
- Destroy，表示在销毁中；
- Failed，表示失败状态。

更多信息可以查看[服务发现](../服务发现/README.md)这一章节
## 整个架构的版本管理

## 资源 / 服务调度

## 服务状态的维持和拟合

## 服务的弹性伸缩和故障迁移

## 服务工作流和编排
