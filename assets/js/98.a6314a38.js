(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{557:function(v,_,t){"use strict";t.r(_);var s=t(36),r=Object(s.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h1",{attrs:{id:"故障排除"}},[v._v("故障排除")]),v._v(" "),t("p",[v._v("故障排除第一定律："),t("strong",[v._v("减少故障影响范围，恢复正常运行")])]),v._v(" "),t("h2",{attrs:{id:"恢复正常"}},[v._v("恢复正常")]),v._v(" "),t("p",[v._v("我们通常有以下手段来恢复系统的正常运行：")]),v._v(" "),t("ul",[t("li",[v._v("重启和限流，重启可以解决可用性的问题，限流基本上要使用限流中间件。")]),v._v(" "),t("li",[v._v("回滚，为了解决新版本的程序代码问题，直接回滚到旧的代码即可。")]),v._v(" "),t("li",[v._v("降级，如果无法回滚代码就直接提供降级服务，比如提供默认值，或者直接提供一个维护中的告示牌也算")]),v._v(" "),t("li",[v._v("紧急更新，需要强大的自动化测试，自动化发布系统，因为要更新很多的机器，毕竟分布式服务下的机器数量是千千万的。没有自动化的 CI/CD，手动一个个发布是不现实的。")])]),v._v(" "),t("h2",{attrs:{id:"故障预演准备工作"}},[v._v("故障预演准备工作")]),v._v(" "),t("p",[v._v("首先我们要建立，以用户功能为索引的服务和资源的"),t("strong",[v._v("全视图")]),v._v("，使用链路追踪的 APM 系统，外加聚合度量的监控系统来构建一个完整的系统视图，这样，才能更加明白问题出在了什么地方。")]),v._v(" "),t("p",[v._v("然后，为每一个服务制定关键指标，并且有一套运维工具，以及"),t("strong",[v._v("应急预案")]),v._v("，比如 redis 出什么问题，用什么手段解决，MySQL 出什么问题用什么手段解决，这都要有工作手册。")]),v._v(" "),t("p",[t("strong",[v._v("制定故障的等级")]),v._v("，根据等级来调用不同的人，以及资源。比如小的边缘服务出问题，影响不大，直接用自动化脚本来解决就行了。比如核心服务出问题，直接调用值班的同学来解决。")]),v._v(" "),t("p",[v._v("故障要经常"),t("strong",[v._v("演练")]),v._v("，毕竟演戏多了才能熟练不是吗")]),v._v(" "),t("p",[v._v("最后就是发布新的功能时，"),t("strong",[v._v("灰度发布")]),v._v("是必须要做的一个流程，谁知道写的代码都是啥玩意儿。减少错误发生的范围，没问题了再全量发布。")]),v._v(" "),t("h2",{attrs:{id:"故障复盘"}},[v._v("故障复盘")]),v._v(" "),t("p",[v._v("故障处理的整个过程。就像一个 log 一样，需要详细地记录几点几分干了什么事，把故障从发生到解决的所有细节过程都记录下来。")]),v._v(" "),t("p",[v._v("故障原因分析。需要说明故障的原因和分析报告。")]),v._v(" "),t("p",[v._v("需要反思并反问至少 5 个为什么，并为这些 “为什么” 找到答案。")]),v._v(" "),t("p",[v._v("故障后续整改计划。需要针对上述的 “Ask 5 Whys” 说明后续如何举一反三地从根本上解决所有的问题。")]),v._v(" "),t("h2",{attrs:{id:"故障整改办法"}},[v._v("故障整改办法")]),v._v(" "),t("p",[v._v("第一，优化故障获知和故障定位的时间。第二，优化故障的处理方式。第三，优化开发过程中的问题。")]),v._v(" "),t("p",[v._v("举一反三解决当下的故障，从一个故障举一反三的角度思考，解决当前一类的问题，"),t("strong",[v._v("简化复杂、不合理的技术架构")]),v._v("、流程和组织。只有简单优雅的东西才有被改善和优化的可能。")])])}),[],!1,null,null,null);_.default=r.exports}}]);